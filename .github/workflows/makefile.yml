name: Makefile CI

on:
  push:

    paths:
 
      - scripts/**
      - .github/workflows/**
      
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:

    runs-on: ubuntu-latest
    

    steps:
    - uses: actions/checkout@v2
    - name: Run apt update
      run: sudo apt update 
      
    - name: Compile Hundalm
      uses: docker://pandoc/core:2.9 
      with:
        args: >-  # allows you to break string into multiple line 
          --output=./descriptions/hundalm.html
          --toc
          -s 
          --top-level-division=section
          --bibliography=./bibliography/tanguy_bib.bib
          --csl="https://raw.githubusercontent.com/citation-style-language/styles/master/elsevier-harvard.csl"
          --metadata title="Hundalm Tropfstein- und Eish√∂hle"
          ./descriptions/hundalm.md
    
    - name: check for changes
      run: git status
    - name: stage changed files
      run: git add .
    - name: commit changed files
      run: git commit -m "Auto updating Pages"
    - name: fetch from master
      run: git fetch origin master
    - name: push code to master
      run: git push origin HEAD:master
